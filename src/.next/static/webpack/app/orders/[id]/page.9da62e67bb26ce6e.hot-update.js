"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/orders/[id]/page",{

/***/ "(app-pages-browser)/./services/ui/orderService.ts":
/*!*************************************!*\
  !*** ./services/ui/orderService.ts ***!
  \*************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createProductionOrder: function() { return /* binding */ createProductionOrder; },\n/* harmony export */   fetchOrderDetail: function() { return /* binding */ fetchOrderDetail; },\n/* harmony export */   fetchOrdersList: function() { return /* binding */ fetchOrdersList; }\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! uuid */ \"(app-pages-browser)/../node_modules/uuid/dist/esm-browser/v4.js\");\n/* harmony import */ var _shared_schemas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/schemas */ \"(app-pages-browser)/./shared/schemas.ts\");\n/* harmony import */ var _data_dexie_workOrderRepositoryDexie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../data/dexie/workOrderRepositoryDexie */ \"(app-pages-browser)/./data/dexie/workOrderRepositoryDexie.ts\");\n/* harmony import */ var _data_dexie_eventRepositoryDexie__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../data/dexie/eventRepositoryDexie */ \"(app-pages-browser)/./data/dexie/eventRepositoryDexie.ts\");\n/* harmony import */ var _data_dexie_lotRepositoryDexie__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../data/dexie/lotRepositoryDexie */ \"(app-pages-browser)/./data/dexie/lotRepositoryDexie.ts\");\n/* harmony import */ var _data_dexie_productRepositoryDexie__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../data/dexie/productRepositoryDexie */ \"(app-pages-browser)/./data/dexie/productRepositoryDexie.ts\");\n/* harmony import */ var _data_dexie_operationRepositoryDexie__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../data/dexie/operationRepositoryDexie */ \"(app-pages-browser)/./data/dexie/operationRepositoryDexie.ts\");\n/* harmony import */ var _domain_services_aggregation__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../domain/services/aggregation */ \"(app-pages-browser)/./domain/services/aggregation.ts\");\n/* harmony import */ var _productService__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./productService */ \"(app-pages-browser)/./services/ui/productService.ts\");\n/* harmony import */ var _routingService__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./routingService */ \"(app-pages-browser)/./services/ui/routingService.ts\");\n/* harmony import */ var _operationService__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./operationService */ \"(app-pages-browser)/./services/ui/operationService.ts\");\n/* harmony import */ var _lotService__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./lotService */ \"(app-pages-browser)/./services/ui/lotService.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\nconst orderRepo = new _data_dexie_workOrderRepositoryDexie__WEBPACK_IMPORTED_MODULE_1__.ProductionOrderRepositoryDexie();\nconst eventRepo = new _data_dexie_eventRepositoryDexie__WEBPACK_IMPORTED_MODULE_2__.EventRepositoryDexie();\nconst lotRepo = new _data_dexie_lotRepositoryDexie__WEBPACK_IMPORTED_MODULE_3__.LotRepositoryDexie();\nconst productRepo = new _data_dexie_productRepositoryDexie__WEBPACK_IMPORTED_MODULE_4__.ProductRepositoryDexie();\nconst operationRepo = new _data_dexie_operationRepositoryDexie__WEBPACK_IMPORTED_MODULE_5__.OperationRepositoryDexie();\nasync function createProductionOrder(input) {\n    // Validate lotSize if trackingMode != piece\n    if (input.trackingMode !== \"piece\" && (!input.lotSize || input.lotSize <= 0 || input.lotSize > input.quantityRequested)) {\n        throw new Error(\"Lot size is required and must be greater than 0 and less than or equal to target pieces\");\n    }\n    // a) Fetch product by id\n    const product = await (0,_productService__WEBPACK_IMPORTED_MODULE_7__.fetchProductById)(input.productId);\n    if (!product) {\n        throw new Error(\"Product not found\");\n    }\n    // b) Validate that product.activeRoutingVersionId exists\n    if (!product.activeRoutingVersionId) {\n        throw new Error(\"Publish a routing version first\");\n    }\n    // c) Fetch routingVersion active + routingOperations\n    const routingVersion = await (0,_routingService__WEBPACK_IMPORTED_MODULE_8__.fetchRoutingVersionById)(product.activeRoutingVersionId);\n    if (!routingVersion) {\n        throw new Error(\"Active routing version not found\");\n    }\n    if (routingVersion.isDraft) {\n        throw new Error(\"Active routing version is still a draft. Publish it first.\");\n    }\n    const routingOperations = await (0,_routingService__WEBPACK_IMPORTED_MODULE_8__.fetchRoutingOperationsByVersion)(routingVersion.id);\n    if (routingOperations.length === 0) {\n        throw new Error(\"Active routing version has no operations\");\n    }\n    // d) Build routingSnapshot with full operation details\n    const operationsWithDetails = await Promise.all(routingOperations.map(async (ro)=>{\n        const operation = await (0,_operationService__WEBPACK_IMPORTED_MODULE_9__.fetchOperationById)(ro.operationId);\n        if (!operation) {\n            throw new Error(\"Operation \".concat(ro.operationId, \" not found\"));\n        }\n        var _ro_standardMinutesOverride;\n        const standardMinutes = (_ro_standardMinutesOverride = ro.standardMinutesOverride) !== null && _ro_standardMinutesOverride !== void 0 ? _ro_standardMinutesOverride : operation.durationMinutes;\n        var _operation_qualityGate;\n        return {\n            operationId: ro.operationId,\n            sequence: ro.sequence,\n            standardMinutes,\n            operationName: operation.name,\n            qualityGate: (_operation_qualityGate = operation.qualityGate) !== null && _operation_qualityGate !== void 0 ? _operation_qualityGate : false,\n            workCenterId: ro.workCenterIdOverride\n        };\n    }));\n    // Sort by sequence to ensure correct order\n    operationsWithDetails.sort((a, b)=>a.sequence - b.sequence);\n    const routingSnapshot = {\n        id: routingVersion.id,\n        productId: product.id,\n        operations: operationsWithDetails\n    };\n    // e) Create ProductionOrder\n    const workshopId = (0,uuid__WEBPACK_IMPORTED_MODULE_11__[\"default\"])(); // Generate new workshopId for this order\n    const orderId = (0,uuid__WEBPACK_IMPORTED_MODULE_11__[\"default\"])();\n    const order = _shared_schemas__WEBPACK_IMPORTED_MODULE_0__.ProductionOrderSchema.parse({\n        id: orderId,\n        productId: input.productId,\n        quantityRequested: input.quantityRequested,\n        workshopId,\n        routingVersionSnapshot: routingSnapshot,\n        trackingMode: input.trackingMode\n    });\n    // f) Persist via repository\n    await orderRepo.add(order);\n    // g) Create lots if trackingMode != piece\n    if (input.trackingMode !== \"piece\" && input.lotSize) {\n        const lotCount = Math.ceil(input.quantityRequested / input.lotSize);\n        const lots = [];\n        const now = new Date().toISOString();\n        for(let i = 1; i <= lotCount; i++){\n            const isLastLot = i === lotCount;\n            const plannedPieces = isLastLot ? input.quantityRequested - (lotCount - 1) * input.lotSize // Last lot gets remainder\n             : input.lotSize;\n            const lot = _shared_schemas__WEBPACK_IMPORTED_MODULE_0__.LotSchema.parse({\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_11__[\"default\"])(),\n                orderId: orderId,\n                lotNumber: i,\n                plannedPieces,\n                createdAt: now\n            });\n            lots.push(lot);\n        }\n        await lotRepo.createMany(lots);\n    }\n    // Create initial WorkEvent (ProductionOrderCreated)\n    const event = _shared_schemas__WEBPACK_IMPORTED_MODULE_0__.WorkEventSchema.parse({\n        id: (0,uuid__WEBPACK_IMPORTED_MODULE_11__[\"default\"])(),\n        type: \"ProductionOrderCreated\",\n        aggregateId: order.id,\n        workshopId: order.workshopId,\n        timestamp: new Date().toISOString(),\n        payload: {\n            quantity: order.quantityRequested\n        },\n        schemaVersion: 1\n    });\n    await eventRepo.append(event);\n    // Enqueue to outbox\n    const outboxRepo = new _data_dexie_eventRepositoryDexie__WEBPACK_IMPORTED_MODULE_2__.OutboxRepositoryDexie();\n    const outboxEvent = _shared_schemas__WEBPACK_IMPORTED_MODULE_0__.OutboxEventSchema.parse({\n        ...event,\n        status: \"pending\"\n    });\n    await outboxRepo.enqueue(outboxEvent);\n    return order;\n}\nasync function fetchOrdersList() {\n    const orders = await orderRepo.listAll();\n    // Note: currently we don't have multi-workshop listing; listing all orders for demo purposes\n    // Fetch all products in one batch to avoid N+1\n    const productIds = [\n        ...new Set(orders.map((o)=>o.productId))\n    ];\n    const products = await Promise.all(productIds.map((id)=>productRepo.getById(id)));\n    const productMap = new Map(products.filter((p)=>p !== undefined).map((p)=>[\n            p.id,\n            p\n        ]));\n    const vms = await Promise.all(orders.map(async (o)=>{\n        const events = await eventRepo.listByAggregate(o.id);\n        var _o_routingVersionSnapshot;\n        const progress = (0,_domain_services_aggregation__WEBPACK_IMPORTED_MODULE_6__.computeOrderProgressFromEvents)({\n            id: o.id,\n            quantityRequested: o.quantityRequested\n        }, (_o_routingVersionSnapshot = o.routingVersionSnapshot) !== null && _o_routingVersionSnapshot !== void 0 ? _o_routingVersionSnapshot : {\n            id: \"\",\n            operations: []\n        }, events);\n        const product = productMap.get(o.productId);\n        var _product_name, _o_trackingMode;\n        return {\n            orderId: o.id,\n            productId: o.productId,\n            productName: (_product_name = product === null || product === void 0 ? void 0 : product.name) !== null && _product_name !== void 0 ? _product_name : \"Product (\".concat(o.productId.slice(0, 8), \"...)\"),\n            productSku: product === null || product === void 0 ? void 0 : product.sku,\n            targetPieces: progress.targetPieces,\n            completedPieces: progress.completedPieces,\n            wipPieces: progress.wipPieces,\n            processedPieces: progress.processedPieces,\n            scrapPieces: progress.scrapPieces,\n            completionPercent: progress.completionPercent,\n            trackingMode: (_o_trackingMode = o.trackingMode) !== null && _o_trackingMode !== void 0 ? _o_trackingMode : \"piece\",\n            updatedAt: undefined\n        };\n    }));\n    return vms;\n}\nasync function fetchOrderDetail(orderId) {\n    const order = await orderRepo.getById(orderId);\n    if (!order) return null;\n    const events = await eventRepo.listByAggregate(orderId);\n    var _order_routingVersionSnapshot;\n    const routingSnapshot = (_order_routingVersionSnapshot = order.routingVersionSnapshot) !== null && _order_routingVersionSnapshot !== void 0 ? _order_routingVersionSnapshot : {\n        id: \"\",\n        operations: []\n    };\n    // Compute order progress to get correct completionPercent\n    const progress = (0,_domain_services_aggregation__WEBPACK_IMPORTED_MODULE_6__.computeOrderProgressFromEvents)({\n        id: order.id,\n        quantityRequested: order.quantityRequested\n    }, routingSnapshot, events);\n    const stages = (0,_domain_services_aggregation__WEBPACK_IMPORTED_MODULE_6__.computeStageTotalsFromEvents)(routingSnapshot, events);\n    // Fetch operation names to enrich stages\n    const operationIds = [\n        ...new Set(stages.map((s)=>s.operationId))\n    ];\n    const operations = await Promise.all(operationIds.map((id)=>operationRepo.getById(id)));\n    const operationMap = new Map(operations.filter((op)=>op !== undefined).map((op)=>[\n            op.id,\n            op\n        ]));\n    const enrichedStages = stages.map((stage)=>{\n        const operation = operationMap.get(stage.operationId);\n        return {\n            ...stage,\n            operationName: operation === null || operation === void 0 ? void 0 : operation.name\n        };\n    });\n    // Fetch lots if trackingMode != piece\n    let lots = undefined;\n    if (order.trackingMode && order.trackingMode !== \"piece\") {\n        const orderLots = await (0,_lotService__WEBPACK_IMPORTED_MODULE_10__.getLotsForOrder)(order.id);\n        lots = orderLots.map((lot)=>({\n                id: lot.id,\n                lotNumber: lot.lotNumber,\n                plannedPieces: lot.plannedPieces\n            }));\n    }\n    return {\n        order,\n        stages: enrichedStages,\n        processedPieces: progress.processedPieces,\n        completedPieces: progress.completedPieces,\n        wipPieces: progress.wipPieces,\n        completionPercent: progress.completionPercent,\n        avgStageProgress: progress.avgStageProgress,\n        lots\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NlcnZpY2VzL3VpL29yZGVyU2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBb0M7QUFDOEY7QUFDdkM7QUFDUztBQUMzQjtBQUNRO0FBQ0k7QUFDNEI7QUFFN0Q7QUFDd0M7QUFDcEM7QUFDVDtBQUUvQyxNQUFNbUIsWUFBWSxJQUFJYixnR0FBOEJBO0FBQ3BELE1BQU1jLFlBQVksSUFBSWIsa0ZBQW9CQTtBQUMxQyxNQUFNYyxVQUFVLElBQUlaLDhFQUFrQkE7QUFDdEMsTUFBTWEsY0FBYyxJQUFJWixzRkFBc0JBO0FBQzlDLE1BQU1hLGdCQUFnQixJQUFJWiwwRkFBd0JBO0FBeUIzQyxlQUFlYSxzQkFBc0JDLEtBQWlDO0lBQzNFLDRDQUE0QztJQUM1QyxJQUFJQSxNQUFNQyxZQUFZLEtBQUssV0FBWSxFQUFDRCxNQUFNRSxPQUFPLElBQUlGLE1BQU1FLE9BQU8sSUFBSSxLQUFLRixNQUFNRSxPQUFPLEdBQUdGLE1BQU1HLGlCQUFpQixHQUFHO1FBQ3ZILE1BQU0sSUFBSUMsTUFBTTtJQUNsQjtJQUNBLHlCQUF5QjtJQUN6QixNQUFNQyxVQUFVLE1BQU1oQixpRUFBZ0JBLENBQUNXLE1BQU1NLFNBQVM7SUFDdEQsSUFBSSxDQUFDRCxTQUFTO1FBQ1osTUFBTSxJQUFJRCxNQUFNO0lBQ2xCO0lBRUEseURBQXlEO0lBQ3pELElBQUksQ0FBQ0MsUUFBUUUsc0JBQXNCLEVBQUU7UUFDbkMsTUFBTSxJQUFJSCxNQUFNO0lBQ2xCO0lBRUEscURBQXFEO0lBQ3JELE1BQU1JLGlCQUFpQixNQUFNbEIsd0VBQXVCQSxDQUFDZSxRQUFRRSxzQkFBc0I7SUFDbkYsSUFBSSxDQUFDQyxnQkFBZ0I7UUFDbkIsTUFBTSxJQUFJSixNQUFNO0lBQ2xCO0lBQ0EsSUFBSUksZUFBZUMsT0FBTyxFQUFFO1FBQzFCLE1BQU0sSUFBSUwsTUFBTTtJQUNsQjtJQUVBLE1BQU1NLG9CQUFvQixNQUFNbkIsZ0ZBQStCQSxD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Q0MsV0FBV1IsU0FBU1EsU0FBUztRQUM3QkcsbUJBQW1CWCxTQUFTVyxpQkFBaUI7UUFDN0NXLGtCQUFrQnRCLFNBQVNzQixnQkFBZ0I7UUFDM0M5RDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc2VydmljZXMvdWkvb3JkZXJTZXJ2aWNlLnRzPzUwYzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQgeyBQcm9kdWN0aW9uT3JkZXIsIFByb2R1Y3Rpb25PcmRlclNjaGVtYSwgV29ya0V2ZW50U2NoZW1hLCBPdXRib3hFdmVudFNjaGVtYSwgTG90LCBMb3RTY2hlbWEgfSBmcm9tICcuLi8uLi9zaGFyZWQvc2NoZW1hcyc7XG5pbXBvcnQgeyBQcm9kdWN0aW9uT3JkZXJSZXBvc2l0b3J5RGV4aWUgfSBmcm9tICcuLi8uLi9kYXRhL2RleGllL3dvcmtPcmRlclJlcG9zaXRvcnlEZXhpZSc7XG5pbXBvcnQgeyBFdmVudFJlcG9zaXRvcnlEZXhpZSwgT3V0Ym94UmVwb3NpdG9yeURleGllIH0gZnJvbSAnLi4vLi4vZGF0YS9kZXhpZS9ldmVudFJlcG9zaXRvcnlEZXhpZSc7XG5pbXBvcnQgeyBMb3RSZXBvc2l0b3J5RGV4aWUgfSBmcm9tICcuLi8uLi9kYXRhL2RleGllL2xvdFJlcG9zaXRvcnlEZXhpZSc7XG5pbXBvcnQgeyBQcm9kdWN0UmVwb3NpdG9yeURleGllIH0gZnJvbSAnLi4vLi4vZGF0YS9kZXhpZS9wcm9kdWN0UmVwb3NpdG9yeURleGllJztcbmltcG9ydCB7IE9wZXJhdGlvblJlcG9zaXRvcnlEZXhpZSB9IGZyb20gJy4uLy4uL2RhdGEvZGV4aWUvb3BlcmF0aW9uUmVwb3NpdG9yeURleGllJztcbmltcG9ydCB7IGNvbXB1dGVPcmRlclByb2dyZXNzRnJvbUV2ZW50cywgY29tcHV0ZVN0YWdlVG90YWxzRnJvbUV2ZW50cyB9IGZyb20gJy4uLy4uL2RvbWFpbi9zZXJ2aWNlcy9hZ2dyZWdhdGlvbic7XG5pbXBvcnQgeyBjb21wdXRlTG90UHJvZ3Jlc3NGcm9tRXZlbnRzIH0gZnJvbSAnLi4vLi4vZG9tYWluL3NlcnZpY2VzL2xvdFByb2dyZXNzJztcbmltcG9ydCB7IGZldGNoUHJvZHVjdEJ5SWQgfSBmcm9tICcuL3Byb2R1Y3RTZXJ2aWNlJztcbmltcG9ydCB7IGZldGNoUm91dGluZ1ZlcnNpb25CeUlkLCBmZXRjaFJvdXRpbmdPcGVyYXRpb25zQnlWZXJzaW9uIH0gZnJvbSAnLi9yb3V0aW5nU2VydmljZSc7XG5pbXBvcnQgeyBmZXRjaE9wZXJhdGlvbkJ5SWQgfSBmcm9tICcuL29wZXJhdGlvblNlcnZpY2UnO1xuaW1wb3J0IHsgZ2V0TG90c0Zvck9yZGVyIH0gZnJvbSAnLi9sb3RTZXJ2aWNlJztcblxuY29uc3Qgb3JkZXJSZXBvID0gbmV3IFByb2R1Y3Rpb25PcmRlclJlcG9zaXRvcnlEZXhpZSgpO1xuY29uc3QgZXZlbnRSZXBvID0gbmV3IEV2ZW50UmVwb3NpdG9yeURleGllKCk7XG5jb25zdCBsb3RSZXBvID0gbmV3IExvdFJlcG9zaXRvcnlEZXhpZSgpO1xuY29uc3QgcHJvZHVjdFJlcG8gPSBuZXcgUHJvZHVjdFJlcG9zaXRvcnlEZXhpZSgpO1xuY29uc3Qgb3BlcmF0aW9uUmVwbyA9IG5ldyBPcGVyYXRpb25SZXBvc2l0b3J5RGV4aWUoKTtcblxuZXhwb3J0IHR5cGUgQ3JlYXRlUHJvZHVjdGlvbk9yZGVySW5wdXQgPSB7XG4gIHByb2R1Y3RJZDogc3RyaW5nO1xuICBxdWFudGl0eVJlcXVlc3RlZDogbnVtYmVyO1xuICB0cmFja2luZ01vZGU6ICdwaWVjZScgfCAnbG90JyB8ICdoeWJyaWQnO1xuICBsb3RTaXplPzogbnVtYmVyOyAvLyBSZXF1aXJlZCBpZiB0cmFja2luZ01vZGUgIT0gJ3BpZWNlJ1xuICBub3Rlcz86IHN0cmluZztcbn07XG5cbnR5cGUgUm91dGluZ1NuYXBzaG90T3BlcmF0aW9uID0ge1xuICBvcGVyYXRpb25JZDogc3RyaW5nO1xuICBzZXF1ZW5jZTogbnVtYmVyO1xuICBzdGFuZGFyZE1pbnV0ZXM6IG51bWJlcjsgLy8gUmVxdWlyZWQgZm9yIGFnZ3JlZ2F0aW9uXG4gIG9wZXJhdGlvbk5hbWU/OiBzdHJpbmc7IC8vIE9wdGlvbmFsOiBmb3IgVUkgZGlzcGxheVxuICBxdWFsaXR5R2F0ZT86IGJvb2xlYW47IC8vIE9wdGlvbmFsOiBmb3IgZnV0dXJlIHVzZVxuICB3b3JrQ2VudGVySWQ/OiBzdHJpbmc7IC8vIE9wdGlvbmFsOiBvdmVycmlkZVxufTtcblxudHlwZSBSb3V0aW5nU25hcHNob3QgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIHByb2R1Y3RJZDogc3RyaW5nO1xuICBvcGVyYXRpb25zOiBSb3V0aW5nU25hcHNob3RPcGVyYXRpb25bXTtcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0aW9uT3JkZXIoaW5wdXQ6IENyZWF0ZVByb2R1Y3Rpb25PcmRlcklucHV0KTogUHJvbWlzZTxQcm9kdWN0aW9uT3JkZXI+IHtcbiAgLy8gVmFsaWRhdGUgbG90U2l6ZSBpZiB0cmFja2luZ01vZGUgIT0gcGllY2VcbiAgaWYgKGlucHV0LnRyYWNraW5nTW9kZSAhPT0gJ3BpZWNlJyAmJiAoIWlucHV0LmxvdFNpemUgfHwgaW5wdXQubG90U2l6ZSA8PSAwIHx8IGlucHV0LmxvdFNpemUgPiBpbnB1dC5xdWFudGl0eVJlcXVlc3RlZCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvdCBzaXplIGlzIHJlcXVpcmVkIGFuZCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGFyZ2V0IHBpZWNlcycpO1xuICB9XG4gIC8vIGEpIEZldGNoIHByb2R1Y3QgYnkgaWRcbiAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGZldGNoUHJvZHVjdEJ5SWQoaW5wdXQucHJvZHVjdElkKTtcbiAgaWYgKCFwcm9kdWN0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQcm9kdWN0IG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgLy8gYikgVmFsaWRhdGUgdGhhdCBwcm9kdWN0LmFjdGl2ZVJvdXRpbmdWZXJzaW9uSWQgZXhpc3RzXG4gIGlmICghcHJvZHVjdC5hY3RpdmVSb3V0aW5nVmVyc2lvbklkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQdWJsaXNoIGEgcm91dGluZyB2ZXJzaW9uIGZpcnN0Jyk7XG4gIH1cblxuICAvLyBjKSBGZXRjaCByb3V0aW5nVmVyc2lvbiBhY3RpdmUgKyByb3V0aW5nT3BlcmF0aW9uc1xuICBjb25zdCByb3V0aW5nVmVyc2lvbiA9IGF3YWl0IGZldGNoUm91dGluZ1ZlcnNpb25CeUlkKHByb2R1Y3QuYWN0aXZlUm91dGluZ1ZlcnNpb25JZCk7XG4gIGlmICghcm91dGluZ1ZlcnNpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FjdGl2ZSByb3V0aW5nIHZlcnNpb24gbm90IGZvdW5kJyk7XG4gIH1cbiAgaWYgKHJvdXRpbmdWZXJzaW9uLmlzRHJhZnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FjdGl2ZSByb3V0aW5nIHZlcnNpb24gaXMgc3RpbGwgYSBkcmFmdC4gUHVibGlzaCBpdCBmaXJzdC4nKTtcbiAgfVxuXG4gIGNvbnN0IHJvdXRpbmdPcGVyYXRpb25zID0gYXdhaXQgZmV0Y2hSb3V0aW5nT3BlcmF0aW9uc0J5VmVyc2lvbihyb3V0aW5nVmVyc2lvbi5pZCk7XG4gIGlmIChyb3V0aW5nT3BlcmF0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FjdGl2ZSByb3V0aW5nIHZlcnNpb24gaGFzIG5vIG9wZXJhdGlvbnMnKTtcbiAgfVxuXG4gIC8vIGQpIEJ1aWxkIHJvdXRpbmdTbmFwc2hvdCB3aXRoIGZ1bGwgb3BlcmF0aW9uIGRldGFpbHNcbiAgY29uc3Qgb3BlcmF0aW9uc1dpdGhEZXRhaWxzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgcm91dGluZ09wZXJhdGlvbnMubWFwKGFzeW5jIChybykgPT4ge1xuICAgICAgY29uc3Qgb3BlcmF0aW9uID0gYXdhaXQgZmV0Y2hPcGVyYXRpb25CeUlkKHJvLm9wZXJhdGlvbklkKTtcbiAgICAgIGlmICghb3BlcmF0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgT3BlcmF0aW9uICR7cm8ub3BlcmF0aW9uSWR9IG5vdCBmb3VuZGApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzdGFuZGFyZE1pbnV0ZXMgPSByby5zdGFuZGFyZE1pbnV0ZXNPdmVycmlkZSA/PyBvcGVyYXRpb24uZHVyYXRpb25NaW51dGVzO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBvcGVyYXRpb25JZDogcm8ub3BlcmF0aW9uSWQsXG4gICAgICAgIHNlcXVlbmNlOiByby5zZXF1ZW5jZSxcbiAgICAgICAgc3RhbmRhcmRNaW51dGVzLCAvLyBSZXF1aXJlZCBmb3IgYWdncmVnYXRpb25cbiAgICAgICAgb3BlcmF0aW9uTmFtZTogb3BlcmF0aW9uLm5hbWUsIC8vIE9wdGlvbmFsOiBmb3IgVUkgZGlzcGxheVxuICAgICAgICBxdWFsaXR5R2F0ZTogb3BlcmF0aW9uLnF1YWxpdHlHYXRlID8/IGZhbHNlLCAvLyBPcHRpb25hbDogZm9yIGZ1dHVyZSB1c2VcbiAgICAgICAgd29ya0NlbnRlcklkOiByby53b3JrQ2VudGVySWRPdmVycmlkZSwgLy8gT3B0aW9uYWw6IG92ZXJyaWRlXG4gICAgICB9IGFzIFJvdXRpbmdTbmFwc2hvdE9wZXJhdGlvbjtcbiAgICB9KVxuICApO1xuXG4gIC8vIFNvcnQgYnkgc2VxdWVuY2UgdG8gZW5zdXJlIGNvcnJlY3Qgb3JkZXJcbiAgb3BlcmF0aW9uc1dpdGhEZXRhaWxzLnNvcnQoKGEsIGIpID0+IGEuc2VxdWVuY2UgLSBiLnNlcXVlbmNlKTtcblxuICBjb25zdCByb3V0aW5nU25hcHNob3Q6IFJvdXRpbmdTbmFwc2hvdCA9IHtcbiAgICBpZDogcm91dGluZ1ZlcnNpb24uaWQsXG4gICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxuICAgIG9wZXJhdGlvbnM6IG9wZXJhdGlvbnNXaXRoRGV0YWlscyxcbiAgfTtcblxuICAvLyBlKSBDcmVhdGUgUHJvZHVjdGlvbk9yZGVyXG4gIGNvbnN0IHdvcmtzaG9wSWQgPSB1dWlkdjQoKTsgLy8gR2VuZXJhdGUgbmV3IHdvcmtzaG9wSWQgZm9yIHRoaXMgb3JkZXJcbiAgY29uc3Qgb3JkZXJJZCA9IHV1aWR2NCgpO1xuICBjb25zdCBvcmRlciA9IFByb2R1Y3Rpb25PcmRlclNjaGVtYS5wYXJzZSh7XG4gICAgaWQ6IG9yZGVySWQsXG4gICAgcHJvZHVjdElkOiBpbnB1dC5wcm9kdWN0SWQsXG4gICAgcXVhbnRpdHlSZXF1ZXN0ZWQ6IGlucHV0LnF1YW50aXR5UmVxdWVzdGVkLFxuICAgIHdvcmtzaG9wSWQsXG4gICAgcm91dGluZ1ZlcnNpb25TbmFwc2hvdDogcm91dGluZ1NuYXBzaG90LFxuICAgIHRyYWNraW5nTW9kZTogaW5wdXQudHJhY2tpbmdNb2RlLFxuICB9KTtcblxuICAvLyBmKSBQZXJzaXN0IHZpYSByZXBvc2l0b3J5XG4gIGF3YWl0IG9yZGVyUmVwby5hZGQob3JkZXIpO1xuXG4gIC8vIGcpIENyZWF0ZSBsb3RzIGlmIHRyYWNraW5nTW9kZSAhPSBwaWVjZVxuICBpZiAoaW5wdXQudHJhY2tpbmdNb2RlICE9PSAncGllY2UnICYmIGlucHV0LmxvdFNpemUpIHtcbiAgICBjb25zdCBsb3RDb3VudCA9IE1hdGguY2VpbChpbnB1dC5xdWFudGl0eVJlcXVlc3RlZCAvIGlucHV0LmxvdFNpemUpO1xuICAgIGNvbnN0IGxvdHM6IExvdFtdID0gW107XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbG90Q291bnQ7IGkrKykge1xuICAgICAgY29uc3QgaXNMYXN0TG90ID0gaSA9PT0gbG90Q291bnQ7XG4gICAgICBjb25zdCBwbGFubmVkUGllY2VzID0gaXNMYXN0TG90XG4gICAgICAgID8gaW5wdXQucXVhbnRpdHlSZXF1ZXN0ZWQgLSAobG90Q291bnQgLSAxKSAqIGlucHV0LmxvdFNpemUgLy8gTGFzdCBsb3QgZ2V0cyByZW1haW5kZXJcbiAgICAgICAgOiBpbnB1dC5sb3RTaXplO1xuXG4gICAgICBjb25zdCBsb3QgPSBMb3RTY2hlbWEucGFyc2Uoe1xuICAgICAgICBpZDogdXVpZHY0KCksXG4gICAgICAgIG9yZGVySWQ6IG9yZGVySWQsXG4gICAgICAgIGxvdE51bWJlcjogaSxcbiAgICAgICAgcGxhbm5lZFBpZWNlcyxcbiAgICAgICAgY3JlYXRlZEF0OiBub3csXG4gICAgICB9KTtcbiAgICAgIGxvdHMucHVzaChsb3QpO1xuICAgIH1cblxuICAgIGF3YWl0IGxvdFJlcG8uY3JlYXRlTWFueShsb3RzKTtcbiAgfVxuXG4gIC8vIENyZWF0ZSBpbml0aWFsIFdvcmtFdmVudCAoUHJvZHVjdGlvbk9yZGVyQ3JlYXRlZClcbiAgY29uc3QgZXZlbnQgPSBXb3JrRXZlbnRTY2hlbWEucGFyc2Uoe1xuICAgIGlkOiB1dWlkdjQoKSxcbiAgICB0eXBlOiAnUHJvZHVjdGlvbk9yZGVyQ3JlYXRlZCcsXG4gICAgYWdncmVnYXRlSWQ6IG9yZGVyLmlkLFxuICAgIHdvcmtzaG9wSWQ6IG9yZGVyLndvcmtzaG9wSWQsXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgcGF5bG9hZDogeyBxdWFudGl0eTogb3JkZXIucXVhbnRpdHlSZXF1ZXN0ZWQgfSxcbiAgICBzY2hlbWFWZXJzaW9uOiAxLFxuICB9KTtcbiAgYXdhaXQgZXZlbnRSZXBvLmFwcGVuZChldmVudCk7XG5cbiAgLy8gRW5xdWV1ZSB0byBvdXRib3hcbiAgY29uc3Qgb3V0Ym94UmVwbyA9IG5ldyBPdXRib3hSZXBvc2l0b3J5RGV4aWUoKTtcbiAgY29uc3Qgb3V0Ym94RXZlbnQgPSBPdXRib3hFdmVudFNjaGVtYS5wYXJzZSh7XG4gICAgLi4uZXZlbnQsXG4gICAgc3RhdHVzOiAncGVuZGluZycgYXMgY29uc3QsXG4gIH0pO1xuICBhd2FpdCBvdXRib3hSZXBvLmVucXVldWUob3V0Ym94RXZlbnQpO1xuXG4gIHJldHVybiBvcmRlcjtcbn1cblxuZXhwb3J0IHR5cGUgT3JkZXJzTGlzdFZNID0ge1xuICBvcmRlcklkOiBzdHJpbmc7XG4gIHByb2R1Y3RJZDogc3RyaW5nO1xuICBwcm9kdWN0TmFtZTogc3RyaW5nO1xuICBwcm9kdWN0U2t1Pzogc3RyaW5nO1xuICB0YXJnZXRQaWVjZXM6IG51bWJlcjtcbiAgY29tcGxldGVkUGllY2VzOiBudW1iZXI7XG4gIHdpcFBpZWNlczogbnVtYmVyO1xuICBwcm9jZXNzZWRQaWVjZXM6IG51bWJlcjtcbiAgc2NyYXBQaWVjZXM6IG51bWJlcjtcbiAgY29tcGxldGlvblBlcmNlbnQ6IG51bWJlcjtcbiAgdHJhY2tpbmdNb2RlOiAncGllY2UnIHwgJ2xvdCcgfCAnaHlicmlkJztcbiAgdXBkYXRlZEF0Pzogc3RyaW5nO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoT3JkZXJzTGlzdCgpOiBQcm9taXNlPE9yZGVyc0xpc3RWTVtdPiB7XG4gIGNvbnN0IG9yZGVycyA9IGF3YWl0IG9yZGVyUmVwby5saXN0QWxsKCk7XG4gIC8vIE5vdGU6IGN1cnJlbnRseSB3ZSBkb24ndCBoYXZlIG11bHRpLXdvcmtzaG9wIGxpc3Rpbmc7IGxpc3RpbmcgYWxsIG9yZGVycyBmb3IgZGVtbyBwdXJwb3Nlc1xuICBcbiAgLy8gRmV0Y2ggYWxsIHByb2R1Y3RzIGluIG9uZSBiYXRjaCB0byBhdm9pZCBOKzFcbiAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KG9yZGVycy5tYXAoKG8pID0+IG8ucHJvZHVjdElkKSldO1xuICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IFByb21pc2UuYWxsKHByb2R1Y3RJZHMubWFwKChpZCkgPT4gcHJvZHVjdFJlcG8uZ2V0QnlJZChpZCkpKTtcbiAgY29uc3QgcHJvZHVjdE1hcCA9IG5ldyBNYXAocHJvZHVjdHMuZmlsdGVyKChwKTogcCBpcyBOb25OdWxsYWJsZTx0eXBlb2YgcD4gPT4gcCAhPT0gdW5kZWZpbmVkKS5tYXAoKHApID0+IFtwLmlkLCBwXSkpO1xuXG4gIGNvbnN0IHZtcyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgIG9yZGVycy5tYXAoYXN5bmMgKG8pID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50cyA9IGF3YWl0IGV2ZW50UmVwby5saXN0QnlBZ2dyZWdhdGUoby5pZCk7XG4gICAgICBjb25zdCBwcm9ncmVzcyA9IGNvbXB1dGVPcmRlclByb2dyZXNzRnJvbUV2ZW50cyh7IGlkOiBvLmlkLCBxdWFudGl0eVJlcXVlc3RlZDogby5xdWFudGl0eVJlcXVlc3RlZCB9LCAoby5yb3V0aW5nVmVyc2lvblNuYXBzaG90IGFzIGFueSkgPz8geyBpZDogJycsIG9wZXJhdGlvbnM6IFtdIH0sIGV2ZW50cyk7XG4gICAgICBjb25zdCBwcm9kdWN0ID0gcHJvZHVjdE1hcC5nZXQoby5wcm9kdWN0SWQpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb3JkZXJJZDogby5pZCxcbiAgICAgICAgcHJvZHVjdElkOiBvLnByb2R1Y3RJZCxcbiAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3Q/Lm5hbWUgPz8gYFByb2R1Y3QgKCR7by5wcm9kdWN0SWQuc2xpY2UoMCwgOCl9Li4uKWAsXG4gICAgICAgIHByb2R1Y3RTa3U6IHByb2R1Y3Q/LnNrdSxcbiAgICAgICAgdGFyZ2V0UGllY2VzOiBwcm9ncmVzcy50YXJnZXRQaWVjZXMsXG4gICAgICAgIGNvbXBsZXRlZFBpZWNlczogcHJvZ3Jlc3MuY29tcGxldGVkUGllY2VzLFxuICAgICAgICB3aXBQaWVjZXM6IHByb2dyZXNzLndpcFBpZWNlcyxcbiAgICAgICAgcHJvY2Vzc2VkUGllY2VzOiBwcm9ncmVzcy5wcm9jZXNzZWRQaWVjZXMsXG4gICAgICAgIHNjcmFwUGllY2VzOiBwcm9ncmVzcy5zY3JhcFBpZWNlcyxcbiAgICAgICAgY29tcGxldGlvblBlcmNlbnQ6IHByb2dyZXNzLmNvbXBsZXRpb25QZXJjZW50LFxuICAgICAgICB0cmFja2luZ01vZGU6IG8udHJhY2tpbmdNb2RlID8/ICdwaWVjZScsIC8vIERlZmF1bHQgdG8gJ3BpZWNlJyBmb3IgbGVnYWN5IG9yZGVyc1xuICAgICAgICB1cGRhdGVkQXQ6IHVuZGVmaW5lZFxuICAgICAgfSBhcyBPcmRlcnNMaXN0Vk07XG4gICAgfSlcbiAgKTtcbiAgcmV0dXJuIHZtcztcbn1cblxuZXhwb3J0IHR5cGUgT3JkZXJEZXRhaWxWTSA9IHtcbiAgb3JkZXI6IFByb2R1Y3Rpb25PcmRlcjtcbiAgc3RhZ2VzOiBBcnJheTx7XG4gICAgb3BlcmF0aW9uSWQ6IHN0cmluZztcbiAgICBvcGVyYXRpb25OYW1lPzogc3RyaW5nO1xuICAgIHNlcXVlbmNlOiBudW1iZXI7XG4gICAgZG9uZVBpZWNlczogbnVtYmVyO1xuICAgIHNjcmFwUGllY2VzOiBudW1iZXI7XG4gICAgc3RhbmRhcmRNaW51dGVzUHJvZHVjZWQ6IG51bWJlcjtcbiAgfT47XG4gIHByb2Nlc3NlZFBpZWNlczogbnVtYmVyO1xuICBjb21wbGV0ZWRQaWVjZXM6IG51bWJlcjtcbiAgd2lwUGllY2VzOiBudW1iZXI7XG4gIGNvbXBsZXRpb25QZXJjZW50OiBudW1iZXI7XG4gIGF2Z1N0YWdlUHJvZ3Jlc3M/OiBudW1iZXI7XG4gIGxvdHM/OiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBsb3ROdW1iZXI6IG51bWJlcjtcbiAgICBwbGFubmVkUGllY2VzOiBudW1iZXI7XG4gICAgZG9uZVBpZWNlczogbnVtYmVyO1xuICAgIHJlbWFpbmluZ1BpZWNlczogbnVtYmVyO1xuICAgIHN0YXR1czogJ25vdF9zdGFydGVkJyB8ICdpbl9wcm9ncmVzcycgfCAnZG9uZSc7XG4gICAgb3ZlclByb2R1Y2VkOiBib29sZWFuO1xuICAgIHdpcFBpZWNlcz86IG51bWJlcjtcbiAgfT47XG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hPcmRlckRldGFpbChvcmRlcklkOiBzdHJpbmcpOiBQcm9taXNlPE9yZGVyRGV0YWlsVk0gfCBudWxsPiB7XG4gIGNvbnN0IG9yZGVyID0gYXdhaXQgb3JkZXJSZXBvLmdldEJ5SWQob3JkZXJJZCk7XG4gIGlmICghb3JkZXIpIHJldHVybiBudWxsO1xuICBjb25zdCBldmVudHMgPSBhd2FpdCBldmVudFJlcG8ubGlzdEJ5QWdncmVnYXRlKG9yZGVySWQpO1xuICBjb25zdCByb3V0aW5nU25hcHNob3QgPSAob3JkZXIucm91dGluZ1ZlcnNpb25TbmFwc2hvdCBhcyBhbnkpID8/IHsgaWQ6ICcnLCBvcGVyYXRpb25zOiBbXSB9O1xuICBcbiAgLy8gQ29tcHV0ZSBvcmRlciBwcm9ncmVzcyB0byBnZXQgY29ycmVjdCBjb21wbGV0aW9uUGVyY2VudFxuICBjb25zdCBwcm9ncmVzcyA9IGNvbXB1dGVPcmRlclByb2dyZXNzRnJvbUV2ZW50cyhcbiAgICB7IGlkOiBvcmRlci5pZCwgcXVhbnRpdHlSZXF1ZXN0ZWQ6IG9yZGVyLnF1YW50aXR5UmVxdWVzdGVkIH0sXG4gICAgcm91dGluZ1NuYXBzaG90LFxuICAgIGV2ZW50c1xuICApO1xuICBcbiAgY29uc3Qgc3RhZ2VzID0gY29tcHV0ZVN0YWdlVG90YWxzRnJvbUV2ZW50cyhyb3V0aW5nU25hcHNob3QsIGV2ZW50cyk7XG4gIFxuICAvLyBGZXRjaCBvcGVyYXRpb24gbmFtZXMgdG8gZW5yaWNoIHN0YWdlc1xuICBjb25zdCBvcGVyYXRpb25JZHMgPSBbLi4ubmV3IFNldChzdGFnZXMubWFwKChzKSA9PiBzLm9wZXJhdGlvbklkKSldO1xuICBjb25zdCBvcGVyYXRpb25zID0gYXdhaXQgUHJvbWlzZS5hbGwob3BlcmF0aW9uSWRzLm1hcCgoaWQpID0+IG9wZXJhdGlvblJlcG8uZ2V0QnlJZChpZCkpKTtcbiAgY29uc3Qgb3BlcmF0aW9uTWFwID0gbmV3IE1hcChvcGVyYXRpb25zLmZpbHRlcigob3ApOiBvcCBpcyBOb25OdWxsYWJsZTx0eXBlb2Ygb3A+ID0+IG9wICE9PSB1bmRlZmluZWQpLm1hcCgob3ApID0+IFtvcC5pZCwgb3BdKSk7XG5cbiAgY29uc3QgZW5yaWNoZWRTdGFnZXMgPSBzdGFnZXMubWFwKChzdGFnZSkgPT4ge1xuICAgIGNvbnN0IG9wZXJhdGlvbiA9IG9wZXJhdGlvbk1hcC5nZXQoc3RhZ2Uub3BlcmF0aW9uSWQpO1xuICAgIHJldHVybiB7XG4gICAgICAuLi5zdGFnZSxcbiAgICAgIG9wZXJhdGlvbk5hbWU6IG9wZXJhdGlvbj8ubmFtZSxcbiAgICB9O1xuICB9KTtcblxuICAvLyBGZXRjaCBsb3RzIGlmIHRyYWNraW5nTW9kZSAhPSBwaWVjZVxuICBsZXQgbG90czogT3JkZXJEZXRhaWxWTVsnbG90cyddID0gdW5kZWZpbmVkO1xuICBpZiAob3JkZXIudHJhY2tpbmdNb2RlICYmIG9yZGVyLnRyYWNraW5nTW9kZSAhPT0gJ3BpZWNlJykge1xuICAgIGNvbnN0IG9yZGVyTG90cyA9IGF3YWl0IGdldExvdHNGb3JPcmRlcihvcmRlci5pZCk7XG4gICAgbG90cyA9IG9yZGVyTG90cy5tYXAoKGxvdDogeyBpZDogc3RyaW5nOyBsb3ROdW1iZXI6IG51bWJlcjsgcGxhbm5lZFBpZWNlczogbnVtYmVyIH0pID0+ICh7XG4gICAgICBpZDogbG90LmlkLFxuICAgICAgbG90TnVtYmVyOiBsb3QubG90TnVtYmVyLFxuICAgICAgcGxhbm5lZFBpZWNlczogbG90LnBsYW5uZWRQaWVjZXMsXG4gICAgfSkpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBvcmRlcixcbiAgICBzdGFnZXM6IGVucmljaGVkU3RhZ2VzLFxuICAgIHByb2Nlc3NlZFBpZWNlczogcHJvZ3Jlc3MucHJvY2Vzc2VkUGllY2VzLFxuICAgIGNvbXBsZXRlZFBpZWNlczogcHJvZ3Jlc3MuY29tcGxldGVkUGllY2VzLFxuICAgIHdpcFBpZWNlczogcHJvZ3Jlc3Mud2lwUGllY2VzLFxuICAgIGNvbXBsZXRpb25QZXJjZW50OiBwcm9ncmVzcy5jb21wbGV0aW9uUGVyY2VudCxcbiAgICBhdmdTdGFnZVByb2dyZXNzOiBwcm9ncmVzcy5hdmdTdGFnZVByb2dyZXNzLFxuICAgIGxvdHMsXG4gIH07XG59XG4iXSwibmFtZXMiOlsidjQiLCJ1dWlkdjQiLCJQcm9kdWN0aW9uT3JkZXJTY2hlbWEiLCJXb3JrRXZlbnRTY2hlbWEiLCJPdXRib3hFdmVudFNjaGVtYSIsIkxvdFNjaGVtYSIsIlByb2R1Y3Rpb25PcmRlclJlcG9zaXRvcnlEZXhpZSIsIkV2ZW50UmVwb3NpdG9yeURleGllIiwiT3V0Ym94UmVwb3NpdG9yeURleGllIiwiTG90UmVwb3NpdG9yeURleGllIiwiUHJvZHVjdFJlcG9zaXRvcnlEZXhpZSIsIk9wZXJhdGlvblJlcG9zaXRvcnlEZXhpZSIsImNvbXB1dGVPcmRlclByb2dyZXNzRnJvbUV2ZW50cyIsImNvbXB1dGVTdGFnZVRvdGFsc0Zyb21FdmVudHMiLCJmZXRjaFByb2R1Y3RCeUlkIiwiZmV0Y2hSb3V0aW5nVmVyc2lvbkJ5SWQiLCJmZXRjaFJvdXRpbmdPcGVyYXRpb25zQnlWZXJzaW9uIiwiZmV0Y2hPcGVyYXRpb25CeUlkIiwiZ2V0TG90c0Zvck9yZGVyIiwib3JkZXJSZXBvIiwiZXZlbnRSZXBvIiwibG90UmVwbyIsInByb2R1Y3RSZXBvIiwib3BlcmF0aW9uUmVwbyIsImNyZWF0ZVByb2R1Y3Rpb25PcmRlciIsImlucHV0IiwidHJhY2tpbmdNb2RlIiwibG90U2l6ZSIsInF1YW50aXR5UmVxdWVzdGVkIiwiRXJyb3IiLCJwcm9kdWN0IiwicHJvZHVjdElkIiwiYWN0aXZlUm91dGluZ1ZlcnNpb25JZCIsInJvdXRpbmdWZXJzaW9uIiwiaXNEcmFmdCIsInJvdXRpbmdPcGVyYXRpb25zIiwiaWQiLCJsZW5ndGgiLCJvcGVyYXRpb25zV2l0aERldGFpbHMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwicm8iLCJvcGVyYXRpb24iLCJvcGVyYXRpb25JZCIsInN0YW5kYXJkTWludXRlcyIsInN0YW5kYXJkTWludXRlc092ZXJyaWRlIiwiZHVyYXRpb25NaW51dGVzIiwic2VxdWVuY2UiLCJvcGVyYXRpb25OYW1lIiwibmFtZSIsInF1YWxpdHlHYXRlIiwid29ya0NlbnRlcklkIiwid29ya0NlbnRlcklkT3ZlcnJpZGUiLCJzb3J0IiwiYSIsImIiLCJyb3V0aW5nU25hcHNob3QiLCJvcGVyYXRpb25zIiwid29ya3Nob3BJZCIsIm9yZGVySWQiLCJvcmRlciIsInBhcnNlIiwicm91dGluZ1ZlcnNpb25TbmFwc2hvdCIsImFkZCIsImxvdENvdW50IiwiTWF0aCIsImNlaWwiLCJsb3RzIiwibm93IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiaSIsImlzTGFzdExvdCIsInBsYW5uZWRQaWVjZXMiLCJsb3QiLCJsb3ROdW1iZXIiLCJjcmVhdGVkQXQiLCJwdXNoIiwiY3JlYXRlTWFueSIsImV2ZW50IiwidHlwZSIsImFnZ3JlZ2F0ZUlkIiwidGltZXN0YW1wIiwicGF5bG9hZCIsInF1YW50aXR5Iiwic2NoZW1hVmVyc2lvbiIsImFwcGVuZCIsIm91dGJveFJlcG8iLCJvdXRib3hFdmVudCIsInN0YXR1cyIsImVucXVldWUiLCJmZXRjaE9yZGVyc0xpc3QiLCJvcmRlcnMiLCJsaXN0QWxsIiwicHJvZHVjdElkcyIsIlNldCIsIm8iLCJwcm9kdWN0cyIsImdldEJ5SWQiLCJwcm9kdWN0TWFwIiwiTWFwIiwiZmlsdGVyIiwicCIsInVuZGVmaW5lZCIsInZtcyIsImV2ZW50cyIsImxpc3RCeUFnZ3JlZ2F0ZSIsInByb2dyZXNzIiwiZ2V0IiwicHJvZHVjdE5hbWUiLCJzbGljZSIsInByb2R1Y3RTa3UiLCJza3UiLCJ0YXJnZXRQaWVjZXMiLCJjb21wbGV0ZWRQaWVjZXMiLCJ3aXBQaWVjZXMiLCJwcm9jZXNzZWRQaWVjZXMiLCJzY3JhcFBpZWNlcyIsImNvbXBsZXRpb25QZXJjZW50IiwidXBkYXRlZEF0IiwiZmV0Y2hPcmRlckRldGFpbCIsInN0YWdlcyIsIm9wZXJhdGlvbklkcyIsInMiLCJvcGVyYXRpb25NYXAiLCJvcCIsImVucmljaGVkU3RhZ2VzIiwic3RhZ2UiLCJvcmRlckxvdHMiLCJhdmdTdGFnZVByb2dyZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./services/ui/orderService.ts\n"));

/***/ })

});